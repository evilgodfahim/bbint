<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bonikbarta Combined Feed</title>
</head>
<body>
<h1>Bonikbarta Combined Latest Posts</h1>
<ul id="posts"></ul>

<script>
const apiURLs = [
  "https://bonikbarta.com/api/post-lists/17?root_path=00000000010000000001",
  "https://bonikbarta.com/api/post-lists/18?root_path=00000000010000000001",
  "https://bonikbarta.com/api/post-lists/19?root_path=00000000010000000001",
  "https://bonikbarta.com/api/post-lists/20?root_path=00000000010000000001",
  "https://bonikbarta.com/api/post-lists/21?root_path=00000000010000000001",
  "https://bonikbarta.com/api/post-lists/22?root_path=00000000010000000001",
  "https://bonikbarta.com/api/post-lists/23?root_path=00000000010000000001"
];
const baseURL = "https://bonikbarta.com";

async function fetchAll() {
  let allItems = [];

  for (let url of apiURLs) {
    try {
      const response = await fetch(url);
      const data = await response.json();
      const items = (data.posts && Array.isArray(data.posts)) 
        ? data.posts 
        : ((data.content && data.content.items) || []);
      allItems = allItems.concat(items);
    } catch (err) {
      console.error("Failed to load from", url, err);
    }
  }

  // Sort by published date (newest first)
  allItems.sort((a, b) => new Date(b.first_published_at) - new Date(a.first_published_at));

  const postList = document.getElementById("posts");

  if (allItems.length === 0) {
    postList.textContent = "❌ No posts found.";
    return;
  }

  allItems.forEach(item => {
    const li = document.createElement("li");
    const a = document.createElement("a");

    a.textContent = item.title || "No title";

    // ✅ Force-remove "/home" from url_path
    let fullLink = item.url_path || "/";
    fullLink = fullLink.replace(/^\/home/, "");  

    a.href = baseURL + fullLink;
    a.target = "_blank";
    li.appendChild(a);

    if (item.first_published_at) {
      const span = document.createElement("span");
      span.textContent = " - " + new Date(item.first_published_at).toLocaleDateString();
      li.appendChild(span);
    }

    postList.appendChild(li);
  });
}

fetchAll();
</script>
</body>
</html>



